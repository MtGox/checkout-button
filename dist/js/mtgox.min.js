(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=Array.prototype.slice;d=[],m=!1,e=!1,f="https://payment.mtgox.com/css/mtgox.css",i="https://payment.mtgox.com/img/button-logo.png",n="https://socketio.mtgox.com:443",h=document.head||document.getElementsByTagName("head")[0]||document.documentElement,c=function(){function b(){}return b.inArray=function(a,b){var c,d,e;for(d=0,e=a.length;d<e;d++){c=a[d];if(c===b)return!0}return!1},b.getScript=function(a,b){var c;return c=document.createElement("script"),c.type="text/javascript",c.async="async",c.onload=c.onreadystatechange=function(a,d){if(d||!c.readyState||/loaded|complete/.test(c.readyState)){c.onload=c.onreadystatechange=null,h&&c.parentNode&&h.removeChild(c),c=void 0;if(!d)return b(200,"success")}},c.src=a,h.insertBefore(c,h.firstChild)},b.getElementsByClassName=function(c,d,e){var f,g,h,i,j,k;d==null&&(d=document.body),e==null&&(e="");if(document.getElementsByClassName)return d.getElementsByClassName(c);if(d.querySelectorAll!=null)return e=e||"",d.querySelectorAll(e+"."+c);e=e||"*",i=d.getElementsByTagName(e),g=[];for(j=0,k=i.length;j<k;j++)h=i[j],f=(new a(h)).getAttribute("class"),f!=null&&b.inArray(f.split(" "),c)&&g.push(h);return g},b}(),a=function(){function a(a){this.element=a}return a.prototype.hasAttribute=function(a){return this.element.hasAttribute!=null?this.element.hasAttribute(a):this.element[a]!=null?!0:!1},a.prototype.getAttribute=function(a){return a==="class"&&this.element.className!=null?this.element.className:this.element.getAttribute!=null?this.element.getAttribute(a):this.element[a]!=null?this.element[a]:null},a.prototype.setAttribute=function(a,b){return a==="class"&&(this.element.className=b),this.element.setAttribute!=null?this.element.setAttribute(a,b):(this.element[a]=b,b)},a.prototype.appendChild=function(a){return this.element.appendChild(a.get())},a.prototype.clean=function(){var a;a=[];while(this.element.childNodes.length)a.push(this.element.removeChild(this.element.childNodes[0]));return a},a.prototype.get=function(){return this.element},a.prototype.setContent=function(a){return this.element.innerHTML=a},a.create=function(b,c,d){var e,f,g,h,i;c==null&&(c={}),b.indexOf(".")&&(i=b.split("."),b=i[0],f=2<=i.length?o.call(i,1):[],c["class"]=f.join(" ")),g=new a(document.createElement(b));for(e in c)h=c[e],g.setAttribute(e,h);return d!=null&&d.appendChild(g),g},a}(),b=function(){function a(){}return a.parseSIOMessage=function(b){switch(b.op){case"private":return a.parseSIOPrivate(b.private,b[b.private])}},a.parseSIOPrivate=function(b,c){switch(b){case"ticker":return a.updateButtons(c.last_all.value)}},a.updateButtons=function(a){var b,c,e,f,g,h;h=[];for(f=0,g=d.length;f<g;f++)c=d[f],b=c.btc_element.getAttribute("data-amount"),e=Math.round(b*a*100)/100,h.push(c.cur_element.setContent("US$ "+e));return h},a.registerButtonUpdate=function(){var b,c;if(window.io)return b=window.io,c=b.connect(n+"/mtgox?Currency=USD&Channel=ticker"),c.on("message",a.parseSIOMessage)},a}(),l=function(g){var j,k,l,o,p,q,r,s,t,u,v,w,x,y,z;if(g.nodeType==null)return!1;m||(m=!0,c.getScript(n+"/socket.io/socket.io.js",b.registerButtonUpdate)),e||(e=!0,r={rel:"stylesheet",type:"text/css",href:f},t=a.create("link",r),h.insertBefore(t.get(),h.firstChild)),g=new a(g),v={},z=["data-id","data-amount","data-currency"];for(x=0,y=z.length;x<y;x++){j=z[x];if(!g.hasAttribute(j))return!1;v[j.replace("data-","")]=g.getAttribute(j)}return w="https://payment.mtgox.com/"+v.id,p=a.create("a.mtgox-button",{href:w,target:"_blank"}),q=a.create("div.mtgox-button-amount",{},p),l=v.amount+" "+v.currency,k=a.create("span.mtgox-button-btc",{"data-amount":v.amount},q),k.setContent(l),a.create("br",{},q),o=a.create("span.mtgox-button-cur",{},q),o.setContent(l),s=a.create("span.mtgox-button-logo",{},q),u={src:i,width:"88",height:"33"},a.create("img",u,s),g.clean(),g.appendChild(p),d.push({element:g,btc_element:k,cur_element:o})},k=!1,g=function(){var a,b,d,e;if(k===!0)return!0;e=c.getElementsByClassName("mtgox");for(b=0,d=e.length;b<d;b++)a=e[b],l(a);return k=!0},document.readyState==="complete"?g():document.addEventListener!=null?(document.addEventListener("DOMContentLoaded",g,!1),document.addEventListener("load",g,!1)):(document.attachEvent("onreadystatechange",g),document.attachEvent("onload",g)),j={button:l},window.MtGox=j}).call(this);